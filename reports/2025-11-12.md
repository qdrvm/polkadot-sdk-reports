# Report - 12-11-2025

* **Period:** 29102025 - 12112025
* **Previous report:** https://github.com/qdrvm/polkadot-sdk-reports/blob/master/reports/2025-10-28.md
* **Treasury grant scope**: Ref. 1689: Polkadot-SDK improvements proposal 1

### Main highlights:

#### State sync (RAM issue):
* Issue is fixed and tested
* [PR 9247](https://github.com/paritytech/polkadot-sdk/pull/9247) is being updated with more tests
    * Related [PR 227](https://github.com/paritytech/trie/pull/227) into the trie repo. Has been reviewed by Basti (but no approve). Our team member will review this PR as well ASAP
     
#### State sync v3:
* [PR 10296](https://github.com/paritytech/polkadot-sdk/pull/10296) is opened as a draft.
    * Adding state sync protocol version selection logic
    
#### Archive storage
* Introduced necessary fixes for child storage
* Introduced prefix collision workaround
* Fixing keys iteration logic
* Remaining steps
    * Workaround for merkle root calculation (if we will need historical blocks execution)
* Team executed preliminary storage growth with new database schema. To test 1.5mln Paseo blocks were synchronized with full archive mode using latest release of polkadot-sdk and our custom version with compact storage:
    * 36G	paseo-archive-node-1
    * 11G	paseo-compact-archive-node-1

#### Shadow integration.

* After recent upgrade to master jemalloc was added in parity-common
    * Fix PR: https://github.com/paritytech/parity-common/pull/950
* A single collator isolation scenario was tested with the following config
    * 2 second parachain slots
    * 5MB POVs
    * 200Mbps bandwidth
    * 75ms latency between peers
    * 8 RC validators, 1 parachain with 4 collators. Collator-2 is isolated by all other collators

<img width="2390" height="1389" alt="image" src="https://github.com/user-attachments/assets/2988eba2-f54f-469a-9dfc-cccae67e0f84" />

```
============================================================
BLOCK PRODUCTION AND FINALIZATION BY COLLATOR
============================================================
collator-2000-1:
  Total blocks produced: 98
  Blocks finalized: 41 (41.8%)
  Blocks NOT finalized: 57
collator-2000-2:
  Total blocks produced: 14
  Blocks finalized: 11 (78.6%)
  Blocks NOT finalized: 3
collator-2000-3:
  Total blocks produced: 104
  Blocks finalized: 41 (39.4%)
  Blocks NOT finalized: 63
collator-2000-4:
  Total blocks produced: 100
  Blocks finalized: 54 (54.0%)
  Blocks NOT finalized: 46

------------------------------------------------------------
OVERALL: 147/316 blocks finalized (46.5%)
============================================================
```
* Results demonstrate that indeed colluding collators (1, 3, 4) can isolate honest collator (2) effectively reducing its block production rate
* On-going PR introducing changes required for shadow compatibility https://github.com/paritytech/polkadot-sdk/pull/10055
    * someone-unknown [suggested](https://github.com/paritytech/polkadot-sdk/pull/10055#issuecomment-3421627333) reworking this PR with replacing tcp logic for communication with workers, by essentially introducing workers logic into the polkadot-sdk itself
        * discussing keeping PR as is, as changes our changes are only required for shadow simulations, not production code
    * https://github.com/paritytech/litep2p/pull/446

#### Multi-slot collation

* [PR 10022](https://github.com/paritytech/polkadot-sdk/pull/10022) is opened as draft
* PR was tested under shadow with the following configuration:
    * 18 seconds parachain slots
    * 5MB POVs
    * 200Mbps bandwidth
    * 75ms latency between peers
    * 8 RC validators, 1 parachain with 4 collators. Collator-2 is isolated by all other collators

<img width="2390" height="1389" alt="image" src="https://github.com/user-attachments/assets/ebf4f129-f51c-4654-aef0-7ad2551c4ee4" />

```
============================================================
BLOCK PRODUCTION AND FINALIZATION BY COLLATOR
============================================================
collator-2000-1:
  Total blocks produced: 41
  Blocks finalized: 21 (51.2%)
  Blocks NOT finalized: 20
collator-2000-2:
  Total blocks produced: 28
  Blocks finalized: 22 (78.6%)
  Blocks NOT finalized: 6
collator-2000-3:
  Total blocks produced: 27
  Blocks finalized: 21 (77.8%)
  Blocks NOT finalized: 6
collator-2000-4:
  Total blocks produced: 33
  Blocks finalized: 21 (63.6%)
  Blocks NOT finalized: 12

------------------------------------------------------------
OVERALL: 85/129 blocks finalized (65.9%)
============================================================
```
* This time it is clear that with longer slots, even when isolated by colluding collators, 2nd collator was able to maintain good block production rate

#### Faster erasure-coding (RFC-139)
* PR to erasure coding repo with optimizations: https://github.com/paritytech/erasure-coding/pull/16
    * Conducted review by our team member
    * Next steps? (cc @alexggh)
* PR with the new Erasure coding to polkadot-sdk: https://github.com/paritytech/polkadot-sdk/pull/10116
    * Summarized benchmarks [here](https://github.com/paritytech/polkadot-sdk/pull/10116#discussion_r2509571347)
    * As requested, testing scenario when 10% of the nodes are still running old EC
 
